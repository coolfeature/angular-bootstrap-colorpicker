/*! angular-bootstrap-colorpicker 2016-05-31 */
angular.module("colorpicker.module",[]).factory("Helper",function(){"use strict";return{closestSlider:function(a){var b=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector;return b.bind(a)("I")?a.parentNode:a},getOffset:function(a,b){for(var c=0,d=0,e=a.getBoundingClientRect();a&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)b||"BODY"!==a.tagName?(c+=a.scrollLeft,d+=a.scrollTop):(c+=document.documentElement.scrollLeft||a.scrollLeft,d+=document.documentElement.scrollTop||a.scrollTop),a=a.offsetParent;return{top:e.top+window.pageYOffset,left:e.left+window.pageXOffset,scrollX:c,scrollY:d}},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}]}}).factory("Color",["Helper",function(a){"use strict";return{value:{h:1,s:1,b:1,a:1},rgb:function(){var a=this.toRGB();return"rgb("+a.r+","+a.g+","+a.b+")"},rgba:function(){var a=this.toRGB();return"rgba("+a.r+","+a.g+","+a.b+","+a.a+")"},hex:function(){return this.toHex()},RGBtoHSB:function(a,b,c,d){a/=255,b/=255,c/=255;var e,f,g,h;return g=Math.max(a,b,c),h=g-Math.min(a,b,c),e=0===h?null:g===a?(b-c)/h:g===b?(c-a)/h+2:(a-b)/h+4,e=(e+360)%6*60/360,f=0===h?0:h/g,{h:e||1,s:f,b:g,a:d||1}},setColor:function(b){b=b?b.toLowerCase():b;for(var c in a.stringParsers)if(a.stringParsers.hasOwnProperty(c)){var d=a.stringParsers[c],e=d.re.exec(b),f=e&&d.parse(e);if(f)return this.value=this.RGBtoHSB.apply(null,f),!1}},setHue:function(a){this.value.h=1-a},setSaturation:function(a){this.value.s=a},setLightness:function(a){this.value.b=1-a},setAlpha:function(a){this.value.a=parseInt(100*(1-a),10)/100},toRGB:function(a,b,c,d){a||(a=this.value.h,b=this.value.s,c=this.value.b),a*=360;var e,f,g,h,i;return a=a%360/60,i=c*b,h=i*(1-Math.abs(a%2-1)),e=f=g=c-i,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],{r:Math.round(255*e),g:Math.round(255*f),b:Math.round(255*g),a:d||this.value.a}},toHex:function(a,b,c,d){var e=this.toRGB(a,b,c,d);return"#"+(1<<24|parseInt(e.r,10)<<16|parseInt(e.g,10)<<8|parseInt(e.b,10)).toString(16).substr(1)}}}]).factory("Slider",["Helper",function(a){"use strict";var b={maxLeft:0,maxTop:0,callLeft:null,callTop:null,knob:{top:0,left:0}},c={};return{getSlider:function(){return b},getLeftPosition:function(a){return Math.max(0,Math.min(b.maxLeft,b.left+((a.pageX||c.left)-c.left)))},getTopPosition:function(a){return Math.max(0,Math.min(b.maxTop,b.top+((a.pageY||c.top)-c.top)))},setSlider:function(d,e){var f=a.closestSlider(d.target),g=a.getOffset(f,e),h=f.getBoundingClientRect(),i=d.clientX-h.left,j=d.clientY-h.top;b.knob=f.children[0].style,b.left=d.pageX-g.left-window.pageXOffset+g.scrollX,b.top=d.pageY-g.top-window.pageYOffset+g.scrollY,c={left:d.pageX-(i-b.left),top:d.pageY-(j-b.top)}},setSaturation:function(a,c){b={maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},this.setSlider(a,c)},setHue:function(a,c){b={maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},this.setSlider(a,c)},setAlpha:function(a,c){b={maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"},this.setSlider(a,c)},setKnob:function(a,c){b.knob.top=a+"px",b.knob.left=c+"px"}}}]).directive("colorpicker",["$document","$timeout","$compile","Color","Slider","Helper",function(a,b,c,d,e,f){"use strict";return{require:"?ngModel",restrict:"A",link:function(g,h,i,j){function k(){a.on("mousemove",m),a.on("mouseup",n)}function l(){try{O.css("backgroundColor",L[A]())}catch(a){O.css("backgroundColor",L.toHex())}N.css("backgroundColor",L.toHex(L.value.h,1,1,1)),"rgba"===A&&(z.css.backgroundColor=L.toHex())}function m(a){var b=e.getLeftPosition(a),c=e.getTopPosition(a),d=e.getSlider();e.setKnob(c,b),d.callLeft&&L[d.callLeft].call(L,b/100),d.callTop&&L[d.callTop].call(L,c/100),l();var f=L[A]();return h.val(f),j&&g.$apply(j.$setViewValue(f)),F&&R.val(f),!1}function n(){s("colorpicker-selected"),a.off("mousemove",m),a.off("mouseup",n)}function o(a){L.setColor(h.val()),F&&!a&&R.val(h.val()),P.eq(0).css({left:100*L.value.s+"px",top:100-100*L.value.b+"px"}),P.eq(1).css("top",100*(1-L.value.h)+"px"),P.eq(2).css("top",100*(1-L.value.a)+"px"),l()}function p(){var a,b=f.getOffset(h[0]);return angular.isDefined(i.colorpickerParent)&&(b.left=0,b.top=0),"top"===B?a={top:b.top-147,left:b.left}:"right"===B?a={top:b.top,left:b.left+126}:"bottom"===B?a={top:b.top+h[0].offsetHeight+2,left:b.left}:"left"===B&&(a={top:b.top,left:b.left-150}),{top:a.top+"px",left:a.left+"px"}}function q(){t(),y()}function r(){K.hasClass("colorpicker-visible")||(o(),K.addClass("colorpicker-visible").css(p()),s("colorpicker-shown"),C===!1&&a.on("mousedown",q),i.colorpickerIsOpen&&(g[i.colorpickerIsOpen]=!0,g.$$phase||g.$digest()))}function s(a,b,c){j&&g.$emit(a,{name:i.ngModel,value:j.$modelValue,elm:b,cb:c})}function t(){K.hasClass("colorpicker-visible")&&(K.removeClass("colorpicker-visible"),s("colorpicker-closed"),a.off("mousedown",q),i.colorpickerIsOpen&&(g[i.colorpickerIsOpen]=!1,g.$$phase||g.$digest()))}function u(a){g.isProbing?y(a):x(a)}function v(a,b,c,d){var e="rgba("+a+","+b+","+c+","+d+")";L.setColor(e),l();var f=L[A]();h.val(f),j&&g.$apply(j.$setViewValue(f)),F&&R.val(f)}function w(a){return s("colorpicker-probe-move",angular.element(a.target),v),!1}function x(c){return g.isProbing||(g.isProbing=!g.isProbing,b(function(){a.find("body").addClass(S),Q.addClass(S),s("colorpicker-probe-started",Q),a.on("mousemove",w)})),!1}function y(b){return g.isProbing&&(g.isProbing=!g.isProbing,a.find("body").removeClass(S),Q.removeClass(S),s("colorpicker-probe-finished",Q),a.off("mousemove",w)),!1}var z,A=i.colorpicker?i.colorpicker:"hex",B=angular.isDefined(i.colorpickerPosition)?i.colorpickerPosition:"bottom",C=angular.isDefined(i.colorpickerInline)?i.colorpickerInline:!1,D=angular.isDefined(i.colorpickerFixedPosition)?i.colorpickerFixedPosition:!1,E=angular.isDefined(i.colorpickerParent)?h.parent():angular.element(document.body),F=angular.isDefined(i.colorpickerWithInput)?i.colorpickerWithInput:!1,G=F?'<div class="colorpicker-row-col"><input type="text" name="colorpicker-input" spellcheck="false"></div>':"",H=C?"":'<div class="colorpicker-row-col"><button class="colorpicker-probe-btn" type="button">&nbsp;</button></div>',I=C?"":'<div class="colorpicker-row-col"><button type="button" class="close-colorpicker colorpicker-close-btn">&times;</button></div>',J='<div class="colorpicker dropdown"><div class="dropdown-menu"><colorpicker-saturation><i></i></colorpicker-saturation><colorpicker-hue><i></i></colorpicker-hue><colorpicker-alpha><i></i></colorpicker-alpha><colorpicker-preview></colorpicker-preview><span class="colorpicker-row">'+G+H+I+"</span></div></div>",K=angular.element(J),L=d,M=K.find("colorpicker-hue"),N=K.find("colorpicker-saturation"),O=K.find("colorpicker-preview"),P=K.find("i");c(K)(g);var I,Q;if(function(){var a=K.children().children(),b=angular.element(a[a.length-1]).children(),b=angular.element(a[a.length-1]).children(),c=angular.element(b[b.length-2]).children()[0];Q=angular.element(c);var d=angular.element(b[b.length-1]).children()[0];I=angular.element(d)}(),F){var R=K.find("input");R.on("mousedown",function(a){a.stopPropagation()}).on("keyup",function(){var a=this.value;h.val(a),j&&j.$modelValue!==a&&(g.$apply(j.$setViewValue(a)),o(!0))})}"rgba"===A&&(K.addClass("alpha"),z=K.find("colorpicker-alpha"),z.on("click",function(a){e.setAlpha(a,D),m(a)}).on("mousedown",function(a){e.setAlpha(a,D),k()}).on("mouseup",function(a){s("colorpicker-selected-alpha")})),M.on("click",function(a){e.setHue(a,D),m(a)}).on("mousedown",function(a){e.setHue(a,D),k()}).on("mouseup",function(a){s("colorpicker-selected-hue")}),N.on("click",function(a){e.setSaturation(a,D),m(a),angular.isDefined(i.colorpickerCloseOnSelect)&&t()}).on("mousedown",function(a){e.setSaturation(a,D),k()}).on("mouseup",function(a){s("colorpicker-selected-saturation")}),D&&K.addClass("colorpicker-fixed-position"),K.addClass("colorpicker-position-"+B),"true"===C&&K.addClass("colorpicker-inline"),E.append(K),j&&(j.$render=function(){h.val(j.$viewValue),o()}),h.on("blur keyup change",function(){o()}),h.on("$destroy",function(){K.remove()}),C===!1?h.on("click",r):r(),K.on("mousedown",function(a){a.stopPropagation(),a.preventDefault()}),I.on("click",function(){t(),y()}),i.colorpickerIsOpen&&g.$watch(i.colorpickerIsOpen,function(a){a===!0?r():a===!1&&t()}),g.isProbing=!1;var S="eyedropper-cursor-ban";Q.on("mousedown",function(a){a.preventDefault(),u(a)})}}}]);